{"ast":null,"code":"function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nvar token = document.querySelector(\"meta[name='csrf-token']\").content;\nvar headers = {\n  \"Content-Type\": \"application/json\",\n  \"X-CSRF-Token\": token\n};\ndocument.addEventListener('DOMContentLoaded', function () {\n  document.querySelectorAll(\".actions .like\").forEach(function (button) {\n    button.addEventListener(\"click\", like);\n  });\n  document.querySelectorAll(\".actions .dislike\").forEach(function (button) {\n    button.addEventListener(\"click\", dislike);\n  });\n});\n\nfunction like(event) {\n  var actionElement = event.target.closest(\".action\");\n  fetch(\"/likes\", {\n    method: \"POST\",\n    headers: headers,\n    body: JSON.stringify({\n      like: {\n        post_id: actionElement.dataset.postId\n      }\n    })\n  }).then(function (response) {\n    return response.json();\n  }).then(function (json) {\n    return handleLikeFeatureCallback(_objectSpread(_objectSpread({}, json), {}, {\n      actionElement: actionElement\n    }));\n  })[\"catch\"](function (error) {\n    return console.log(\"parsing failed\", error);\n  });\n}\n\nfunction dislike(event) {\n  var actionElement = event.target.closest(\".action\");\n  fetch(\"/likes/\".concat(actionElement.dataset.likeId), {\n    method: \"DELETE\",\n    headers: headers\n  }).then(function (response) {\n    return response.json();\n  }).then(function (json) {\n    return handleLikeFeatureCallback(_objectSpread(_objectSpread({}, json), {}, {\n      actionElement: actionElement\n    }));\n  })[\"catch\"](function (error) {\n    return console.log(\"parsing failed\", error);\n  });\n}\n\nfunction handleLikeFeatureCallback(_ref) {\n  var id = _ref.id,\n      successful = _ref.successful,\n      actionElement = _ref.actionElement;\n\n  if (successful) {\n    actionElement.dataset.likeId = id;\n    actionElement.querySelectorAll(\".like, .dislike\").forEach(function (div) {\n      div.classList.toggle(\"hidden\");\n    });\n  }\n}","map":{"version":3,"names":["token","document","querySelector","content","headers","addEventListener","querySelectorAll","forEach","button","like","dislike","event","actionElement","target","closest","fetch","method","body","JSON","stringify","post_id","dataset","postId","then","response","json","handleLikeFeatureCallback","error","console","log","likeId","id","successful","div","classList","toggle"],"sources":["/home/mattstudy/matgram/app/javascript/packs/likes.js"],"sourcesContent":["const token = document.querySelector(\"meta[name='csrf-token']\").content;\nconst headers = { \"Content-Type\": \"application/json\", \"X-CSRF-Token\": token };\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  document.querySelectorAll(\".actions .like\").forEach(button => {\n    button.addEventListener(\"click\", like);\n  });\n\n  document.querySelectorAll(\".actions .dislike\").forEach(button => {\n    button.addEventListener(\"click\", dislike);\n  });\n});\n\nfunction like(event) {\n  const actionElement = event.target.closest(\".action\");\n\n  fetch(\"/likes\", {\n    method: \"POST\",\n    headers,\n    body: JSON.stringify({ like: { post_id: actionElement.dataset.postId } })\n  })\n    .then(response => response.json())\n    .then(json => handleLikeFeatureCallback({ ...json, actionElement }))\n    .catch(error => console.log(\"parsing failed\", error));\n}\n\nfunction dislike(event) {\n  const actionElement = event.target.closest(\".action\");\n\n  fetch(`/likes/${actionElement.dataset.likeId}`, { method: \"DELETE\", headers })\n    .then(response => response.json())\n    .then(json => handleLikeFeatureCallback({ ...json, actionElement }))\n    .catch(error => console.log(\"parsing failed\", error));\n}\n\nfunction handleLikeFeatureCallback({ id, successful, actionElement }) {\n  if (successful) {\n    actionElement.dataset.likeId = id;\n\n    actionElement.querySelectorAll(\".like, .dislike\").forEach(div => {\n      div.classList.toggle(\"hidden\");\n    });\n  }\n}"],"mappings":";;;;;;AAAA,IAAMA,KAAK,GAAGC,QAAQ,CAACC,aAAT,CAAuB,yBAAvB,EAAkDC,OAAhE;AACA,IAAMC,OAAO,GAAG;EAAE,gBAAgB,kBAAlB;EAAsC,gBAAgBJ;AAAtD,CAAhB;AAEAC,QAAQ,CAACI,gBAAT,CAA0B,kBAA1B,EAA8C,YAAM;EAClDJ,QAAQ,CAACK,gBAAT,CAA0B,gBAA1B,EAA4CC,OAA5C,CAAoD,UAAAC,MAAM,EAAI;IAC5DA,MAAM,CAACH,gBAAP,CAAwB,OAAxB,EAAiCI,IAAjC;EACD,CAFD;EAIAR,QAAQ,CAACK,gBAAT,CAA0B,mBAA1B,EAA+CC,OAA/C,CAAuD,UAAAC,MAAM,EAAI;IAC/DA,MAAM,CAACH,gBAAP,CAAwB,OAAxB,EAAiCK,OAAjC;EACD,CAFD;AAGD,CARD;;AAUA,SAASD,IAAT,CAAcE,KAAd,EAAqB;EACnB,IAAMC,aAAa,GAAGD,KAAK,CAACE,MAAN,CAAaC,OAAb,CAAqB,SAArB,CAAtB;EAEAC,KAAK,CAAC,QAAD,EAAW;IACdC,MAAM,EAAE,MADM;IAEdZ,OAAO,EAAPA,OAFc;IAGda,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe;MAAEV,IAAI,EAAE;QAAEW,OAAO,EAAER,aAAa,CAACS,OAAd,CAAsBC;MAAjC;IAAR,CAAf;EAHQ,CAAX,CAAL,CAKGC,IALH,CAKQ,UAAAC,QAAQ;IAAA,OAAIA,QAAQ,CAACC,IAAT,EAAJ;EAAA,CALhB,EAMGF,IANH,CAMQ,UAAAE,IAAI;IAAA,OAAIC,yBAAyB,iCAAMD,IAAN;MAAYb,aAAa,EAAbA;IAAZ,GAA7B;EAAA,CANZ,WAOS,UAAAe,KAAK;IAAA,OAAIC,OAAO,CAACC,GAAR,CAAY,gBAAZ,EAA8BF,KAA9B,CAAJ;EAAA,CAPd;AAQD;;AAED,SAASjB,OAAT,CAAiBC,KAAjB,EAAwB;EACtB,IAAMC,aAAa,GAAGD,KAAK,CAACE,MAAN,CAAaC,OAAb,CAAqB,SAArB,CAAtB;EAEAC,KAAK,kBAAWH,aAAa,CAACS,OAAd,CAAsBS,MAAjC,GAA2C;IAAEd,MAAM,EAAE,QAAV;IAAoBZ,OAAO,EAAPA;EAApB,CAA3C,CAAL,CACGmB,IADH,CACQ,UAAAC,QAAQ;IAAA,OAAIA,QAAQ,CAACC,IAAT,EAAJ;EAAA,CADhB,EAEGF,IAFH,CAEQ,UAAAE,IAAI;IAAA,OAAIC,yBAAyB,iCAAMD,IAAN;MAAYb,aAAa,EAAbA;IAAZ,GAA7B;EAAA,CAFZ,WAGS,UAAAe,KAAK;IAAA,OAAIC,OAAO,CAACC,GAAR,CAAY,gBAAZ,EAA8BF,KAA9B,CAAJ;EAAA,CAHd;AAID;;AAED,SAASD,yBAAT,OAAsE;EAAA,IAAjCK,EAAiC,QAAjCA,EAAiC;EAAA,IAA7BC,UAA6B,QAA7BA,UAA6B;EAAA,IAAjBpB,aAAiB,QAAjBA,aAAiB;;EACpE,IAAIoB,UAAJ,EAAgB;IACdpB,aAAa,CAACS,OAAd,CAAsBS,MAAtB,GAA+BC,EAA/B;IAEAnB,aAAa,CAACN,gBAAd,CAA+B,iBAA/B,EAAkDC,OAAlD,CAA0D,UAAA0B,GAAG,EAAI;MAC/DA,GAAG,CAACC,SAAJ,CAAcC,MAAd,CAAqB,QAArB;IACD,CAFD;EAGD;AACF"},"metadata":{},"sourceType":"module"}